# ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /getcode –ì–û–¢–û–í–ê!

## üìä –°—Ç–∞—Ç—É—Å: –ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –Ω—É–∂–µ–Ω –¥–µ–ø–ª–æ–π –Ω–∞ Railway

**–î–∞—Ç–∞:** 09.02.2026  
**–ü—Ä–æ–±–ª–µ–º–∞:** Railway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞

---

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ö–æ–º–∞–Ω–¥–∞ `/getcode` —Å–æ–∑–¥–∞–Ω–∞
**–§–∞–π–ª:** `TTFD/discord-bot/py/discord_link_code.py`

–ö–æ–º–∞–Ω–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `@bot.tree.command`:
```python
@bot.tree.command(name="getcode", description="–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞")
async def getcode(interaction: discord.Interaction):
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥
    # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –õ–°
```

### 2. –ö–æ–º–∞–Ω–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ bot.py
**–§–∞–π–ª:** `TTFD/discord-bot/py/bot.py`

```python
import discord_link_code
await discord_link_code.setup_discord_link_commands(bot, db)
```

### 3. –ú–µ—Ç–æ–¥—ã –ë–î —Å—É—â–µ—Å—Ç–≤—É—é—Ç
**–§–∞–π–ª:** `TTFD/discord-bot/py/database.py`

```python
def get_telegram_link(self, discord_id)  # ‚úÖ –ï—Å—Ç—å
def link_telegram(self, discord_id, telegram_id)  # ‚úÖ –ï—Å—Ç—å
def unlink_telegram(self, discord_id)  # ‚úÖ –ï—Å—Ç—å
```

### 4. –ò–º–ø–æ—Ä—Ç asyncpg —É–±—Ä–∞–Ω
**–ë—ã–ª–æ:**
```python
import asyncpg  # ‚ùå
```

**–°—Ç–∞–ª–æ:**
```python
# –ò–º–ø–æ—Ä—Ç —É–±—Ä–∞–Ω ‚úÖ
```

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞

Railway –≤—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞** –≥–¥–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è `asyncpg`.

**–ò–∑ –ª–æ–≥–æ–≤ Railway:**
```
‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥ –ø—Ä–∏–≤—è–∑–∫–∏: No module named 'asyncpg'
File "/app/py/discord_link_code.py", line 9, in <module>
import asyncpg
```

**–ù–æ –≤ GitHub —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –ö–æ–º–º–∏—Ç d9cc663: —É–±—Ä–∞–Ω –∏–º–ø–æ—Ä—Ç asyncpg
- –ö–æ–º–º–∏—Ç 604cf07: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ö–æ–º–º–∏—Ç dd7cff1: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ö–æ–º–º–∏—Ç 281a344: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é

---

## üöÄ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í—Ä—É—á–Ω—É—é –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Railway

1. **–û—Ç–∫—Ä–æ–π Railway Dashboard**
   - railway.app ‚Üí Discord Bot

2. **–ü—Ä–æ–≤–µ—Ä—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π**
   - Deployments ‚Üí Latest
   - –ü—Ä–æ–≤–µ—Ä—å –∫–æ–º–º–∏—Ç (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 281a344 –∏–ª–∏ –Ω–æ–≤–µ–µ)

3. **–ï—Å–ª–∏ —Å—Ç–∞—Ä—ã–π –∫–æ–º–º–∏—Ç - –∑–∞–¥–µ–ø–ª–æ–π –≤—Ä—É—á–Ω—É—é**
   - Settings ‚Üí Service ‚Üí Redeploy
   - –ò–ª–∏ –Ω–∞–∂–º–∏ "Deploy" –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
   - –ü–æ–¥–æ–∂–¥–∏ 1-2 –º–∏–Ω—É—Ç—ã

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä—å Auto Deploy

1. **Settings ‚Üí Service ‚Üí Auto Deploy**
2. **–£–±–µ–¥–∏—Å—å —á—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ (ON)**
3. **–ü—Ä–æ–≤–µ—Ä—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   - –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `1HaveNotSoul/TTFD`
   - –í–µ—Ç–∫–∞: `main`

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—á–∏—Å—Ç–∏ –∫–µ—à

1. **Settings ‚Üí Service**
2. **Clear Cache**
3. **Redeploy**

---

## üìã –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ

### 1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úÖ –ö–æ–º–∞–Ω–¥—ã –ø—Ä–∏–≤—è–∑–∫–∏ —á–µ—Ä–µ–∑ –∫–æ–¥ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã (/getcode, /checklink, /unlink)
‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ X slash –∫–æ–º–∞–Ω–¥ —Å Discord (global sync)
‚è∞ –ö–æ–º–∞–Ω–¥—ã –ø–æ—è–≤—è—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞
```

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚ùå No module named 'asyncpg'
‚ùå 403 Forbidden (error code: 50001): Missing Access
```

### 2. –ü–æ–¥–æ–∂–¥–∏ –¥–æ 1 —á–∞—Å–∞

Global sync –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –¥–æ 1 —á–∞—Å–∞. –ï—Å–ª–∏ guild sync —Å—Ä–∞–±–æ—Ç–∞–ª - –∫–æ–º–∞–Ω–¥—ã –ø–æ—è–≤—è—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.

### 3. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É –≤ Discord

**–í–ê–ñ–ù–û:** –≠—Ç–æ SLASH –∫–æ–º–∞–Ω–¥–∞!

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```
/getcode  (–ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç–µ)
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
1. –ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å `/` –≤ Discord
2. –ü–æ—è–≤–∏—Ç—Å—è –º–µ–Ω—é slash –∫–æ–º–∞–Ω–¥
3. –ù–∞–π–¥–∏ `/getcode` –≤ —Å–ø–∏—Å–∫–µ
4. –ù–∞–∂–º–∏ –Ω–∞ –Ω–µ—ë –∏–ª–∏ Tab
5. –ù–∞–∂–º–∏ Enter

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### Discord –±–æ—Ç (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥)

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /getcode
    ‚Üì
–ë–æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ (6 —Å–∏–º–≤–æ–ª–æ–≤, –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
    ‚Üì
–ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ json/user_data.json:
    {
        "link_code": {
            "code": "ABC123",
            "created_at": "2026-02-09T12:00:00",
            "expires_at": "2026-02-09T12:03:00",
            "used": false
        }
    }
    ‚Üì
–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –õ–° –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

### Telegram –±–æ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–¥)

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /code ABC123
    ‚Üì
–ë–æ—Ç —á–∏—Ç–∞–µ—Ç discord-bot/json/user_data.json
    ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∏:
    ‚úì –ö–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?
    ‚úì –ö–æ–¥ –Ω–µ –∏—Å—Ç—ë–∫? (3 –º–∏–Ω—É—Ç—ã)
    ‚úì –ö–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω?
    ‚Üì
–ü–æ–º–µ—á–∞–µ—Ç –∫–æ–¥ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π
    ‚Üì
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏–≤—è–∑–∫—É –≤ –æ–±–µ–∏—Ö –ë–î:
    - Discord: telegram_id = "123456789"
    - Telegram: discord_link = "987654321"
```

---

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### Discord

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/getcode` | –ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ Telegram |
| `/checklink` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–≤—è–∑–∫–∏ |
| `/unlink` | –û—Ç–≤—è–∑–∞—Ç—å Telegram –∞–∫–∫–∞—É–Ω—Ç |

### Telegram

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/code <–ö–û–î>` | –ü—Ä–∏–≤—è–∑–∞—Ç—å Discord —á–µ—Ä–µ–∑ –∫–æ–¥ |
| `/checklink` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–≤—è–∑–∫–∏ |
| `/unlink` | –û—Ç–≤—è–∑–∞—Ç—å Discord –∞–∫–∫–∞—É–Ω—Ç |

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [x] –ö–æ–º–∞–Ω–¥–∞ `/getcode` —Å–æ–∑–¥–∞–Ω–∞
- [x] –ö–æ–º–∞–Ω–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ bot.py
- [x] –ú–µ—Ç–æ–¥—ã –ë–î —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- [x] –ò–º–ø–æ—Ä—Ç asyncpg —É–±—Ä–∞–Ω
- [x] –ó–∞–ª–∏—Ç–æ –Ω–∞ GitHub
- [ ] –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Railway
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ Railway
- [ ] –ü–æ–¥–æ–∂–¥–∞—Ç—å –¥–æ 1 —á–∞—Å–∞ (global sync)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å `/getcode` –≤ Discord
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å `/code` –≤ Telegram

---

## üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**–ó–ê–î–ï–ü–õ–û–ô –í–†–£–ß–ù–£–Æ –ù–ê RAILWAY!**

1. Railway ‚Üí Discord Bot ‚Üí Settings ‚Üí Redeploy
2. –ü–æ–¥–æ–∂–¥–∏ 1-2 –º–∏–Ω—É—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–∫–∏ asyncpg
4. –ü–æ–¥–æ–∂–¥–∏ –¥–æ 1 —á–∞—Å–∞ (global sync)
5. –ò—Å–ø–æ–ª—å–∑—É–π `/getcode` —á–µ—Ä–µ–∑ –º–µ–Ω—é slash –∫–æ–º–∞–Ω–¥

---

**–î–∞—Ç–∞:** 09.02.2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤, –Ω—É–∂–µ–Ω –¥–µ–ø–ª–æ–π  
**–ö–æ–º–º–∏—Ç—ã:** d9cc663, 604cf07, dd7cff1, 281a344
