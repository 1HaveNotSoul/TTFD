# ‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–í–û–î–ö–ê: –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Telegram ‚Üî Discord

**–î–∞—Ç–∞:** 08.02.2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –≠—Ç–∞–ø 1 –∑–∞–≤–µ—Ä—à—ë–Ω (–±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)  
**–í–µ—Ä—Å–∏—è:** v3.0 + Bidirectional Sync

---

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
**–§–∞–π–ª:** `domain/models/sync_event.py`

- `SyncEvent` - –º–æ–¥–µ–ª—å —Å–æ–±—ã—Ç–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
  - –ü–æ–ª—è: id, idempotency_key, source, event_type, user_id, payload, status, processed_by, retries, error_message
  - –ú–µ—Ç–æ–¥—ã: is_pending, is_completed, is_failed, can_retry
  
- `Transaction` - –º–æ–¥–µ–ª—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∞—É–¥–∏—Ç–∞
  - –ü–æ–ª—è: id, idempotency_key, user_id, source, type, delta_xp, delta_balance, reason, metadata
  
- `SyncState` - –º–æ–¥–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
  - –ü–æ–ª—è: user_id, last_telegram_xp/balance/rank, last_discord_xp/balance/rank, last_reconcile_at
  - –ú–µ—Ç–æ–¥—ã: has_xp_diff, has_balance_diff, has_rank_diff

- Enums:
  - `EventSource` (telegram, discord)
  - `EventType` (xp_change, balance_change, rank_change, achievement_unlock, reward_grant)
  - `EventStatus` (pending, processing, completed, failed)

- –£—Ç–∏–ª–∏—Ç–∞: `generate_idempotency_key()` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π

---

### 2. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚úÖ
**–§–∞–π–ª:** `infrastructure/database/repositories/sync_repository.py`

**–°–æ–±—ã—Ç–∏—è:**
- `create_event()` - —Å–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- `get_event_by_id()` - –ø–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø–æ ID
- `get_event_by_idempotency_key()` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ –∫–ª—é—á—É
- `get_pending_events()` - –ø–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –æ–∂–∏–¥–∞—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `mark_event_processing()` - –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–æ–µ
- `mark_event_completed()` - –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–µ
- `mark_event_failed()` - –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ–≤–∞–ª–∏–≤—à–µ–µ—Å—è
- `retry_event()` - –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
- `get_user_events()` - –ø–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:**
- `create_transaction()` - —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
- `get_user_transactions()` - –ø–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
- `get_sync_state()` - –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `upsert_sync_state()` - –æ–±–Ω–æ–≤–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- `update_reconcile_time()` - –æ–±–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è reconcile
- `increment_reconcile_errors()` - —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
- `get_users_needing_reconcile()` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è reconcile

**–£—Ç–∏–ª–∏—Ç—ã:**
- `cleanup_old_events()` - –æ—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è
- `get_stats()` - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

---

### 3. –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ ‚úÖ
**–§–∞–π–ª:** `domain/services/sync_service.py`

**–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:**
- `create_xp_change_event()` - —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è XP
- `create_balance_change_event()` - —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
- `create_rank_change_event()` - —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–Ω–≥–∞
- `create_achievement_event()` - —Å–æ–±—ã—Ç–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π:**
- `process_event()` - –≥–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `_process_xp_change()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ XP
- `_process_balance_change()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–ª–∞–Ω—Å–∞
- `_process_rank_change()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–Ω–≥–∞
- `_process_achievement()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

**Reconcile:**
- `reconcile_user()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `reconcile_all_users()` - –º–∞—Å—Å–æ–≤—ã–π reconcile

**–£—Ç–∏–ª–∏—Ç—ã:**
- `get_stats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `idempotency_key`
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–∏–Ω–≥-–ø–æ–Ω–≥–∞ —á–µ—Ä–µ–∑ `processed_by`
- ‚úÖ Rank-Derived —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (—Ä–∞–Ω–≥ –∏–∑ XP)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

---

### 4. –§–æ–Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã ‚úÖ
**–§–∞–π–ª:** `application/jobs/sync_worker.py`

**SyncWorker:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–±—ã—Ç–∏–π
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- Batch size: 100 —Å–æ–±—ã—Ç–∏–π
- –ú–µ—Ç–æ–¥—ã: start(), stop(), process_now()

**ReconcileWorker:**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- Batch size: 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ú–µ—Ç–æ–¥—ã: start(), stop(), reconcile_now()

**CleanupWorker:**
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
- Retention: 30 –¥–Ω–µ–π –¥–ª—è completed, 7 –¥–Ω–µ–π –¥–ª—è failed
- –ú–µ—Ç–æ–¥—ã: start(), stop(), cleanup_now()

---

### 5. –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î ‚úÖ
**–§–∞–π–ª:** `infrastructure/database/migrations/006_bidirectional_sync.sql`

**–¢–∞–±–ª–∏—Ü—ã:**

1. **sync_events** - —Å–æ–±—ã—Ç–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - id (UUID, PK)
   - idempotency_key (unique)
   - source (telegram/discord)
   - event_type (xp_change/balance_change/rank_change/achievement_unlock/reward_grant)
   - user_id (FK users)
   - payload (JSONB)
   - status (pending/processing/completed/failed)
   - processed_by (telegram/discord/both)
   - retries, error_message
   - created_at, processed_at
   - –ò–Ω–¥–µ–∫—Å—ã: status, user_id, created_at, idempotency_key

2. **transactions** - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∞—É–¥–∏—Ç–∞
   - id (serial, PK)
   - idempotency_key (unique)
   - user_id (FK users)
   - source (telegram/discord)
   - type (xp/balance/achievement/reward)
   - delta_xp, delta_balance
   - reason, metadata (JSONB)
   - created_at
   - –ò–Ω–¥–µ–∫—Å—ã: user_id, created_at, source

3. **sync_state** - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - user_id (PK, FK users)
   - last_telegram_xp, last_telegram_balance, last_telegram_rank
   - last_discord_xp, last_discord_balance, last_discord_rank
   - last_reconcile_at, reconcile_errors
   - updated_at
   - –¢—Ä–∏–≥–≥–µ—Ä: –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ updated_at

4. **rank_role_mappings** - –º–∞–ø–ø–∏–Ω–≥ —Ä–∞–Ω–≥–æ–≤ –Ω–∞ Discord —Ä–æ–ª–∏
   - id (serial, PK)
   - rank_id (unique)
   - rank_name
   - discord_role_id (unique)
   - discord_role_name
   - priority, is_active
   - created_at, updated_at
   - –¢—Ä–∏–≥–≥–µ—Ä: –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ updated_at
   - –î–∞–Ω–Ω—ã–µ: 20 —Ä–∞–Ω–≥–æ–≤ TTFD (–Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å discord_role_id)

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ discord_links:**
- last_sync_at (timestamp)
- sync_enabled (boolean, default true)

**–§—É–Ω–∫—Ü–∏–∏:**
- `cleanup_old_sync_events()` - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è updated_at

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram Bot   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   Sync Engine    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  Discord Bot    ‚îÇ
‚îÇ   (Python)      ‚îÇ         ‚îÇ  (Event-driven)  ‚îÇ         ‚îÇ   (discord.py)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                            ‚îÇ                            ‚îÇ
        ‚îÇ                            ‚îÇ                            ‚îÇ
        ‚ñº                            ‚ñº                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         PostgreSQL Database                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ sync_events  ‚îÇ  ‚îÇ transactions ‚îÇ  ‚îÇ sync_state   ‚îÇ  ‚îÇ rank_roles  ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏—è (Telegram ‚Üí Discord):

```
1. User –∏–≥—Ä–∞–µ—Ç –≤ –∏–≥—Ä—É ‚Üí –ø–æ–ª—É—á–∞–µ—Ç XP
   ‚Üì
2. GameService.add_xp()
   ‚Üì
3. SyncService.create_xp_change_event(
     source=telegram,
     delta=+50,
     idempotency_key="tg_game_12345_67890"
   )
   ‚Üì
4. –°–æ–±—ã—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ sync_events (status=pending)
   ‚Üì
5. SyncWorker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥)
   ‚Üì
6. SyncService.process_event()
   ‚Üì
7. _process_xp_change() ‚Üí Discord Bot API (TODO)
   ‚Üì
8. –°–æ–±—ã—Ç–∏–µ –ø–æ–º–µ—á–∞–µ—Ç—Å—è (status=completed, processed_by=discord)
```

### –ü–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏—è (Discord ‚Üí Telegram):

```
1. User –ø–æ–ª—É—á–∞–µ—Ç XP –≤ Discord (–≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç)
   ‚Üì
2. Discord Bot on_voice_state_update()
   ‚Üì
3. SyncService.create_xp_change_event(
     source=discord,
     delta=+10,
     idempotency_key="ds_voice_abc_67890"
   )
   ‚Üì
4. –°–æ–±—ã—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ sync_events (status=pending)
   ‚Üì
5. SyncWorker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ
   ‚Üì
6. SyncService.process_event()
   ‚Üì
7. _process_xp_change() ‚Üí UserRepository.update_xp()
   ‚Üì
8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–Ω–≥–∞ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ rank_change —Å–æ–±—ã—Ç–∏—è
   ‚Üì
9. –°–æ–±—ã—Ç–∏–µ –ø–æ–º–µ—á–∞–µ—Ç—Å—è (status=completed, processed_by=telegram)
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:
- ‚úÖ –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `idempotency_key`
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: `{source}_{type}_{entity_id}_{user_id}[_{timestamp}]`

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–∏–Ω–≥-–ø–æ–Ω–≥–∞:
- ‚úÖ –ü–æ–ª–µ `processed_by` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∫—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª —Å–æ–±—ã—Ç–∏–µ
- ‚úÖ –°–æ–±—ã—Ç–∏–µ –∏–∑ Telegram –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Discord
- ‚úÖ –°–æ–±—ã—Ç–∏–µ –∏–∑ Discord –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Telegram
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤

### Rank-Derived —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:
- ‚úÖ –†–∞–Ω–≥ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ XP (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)
- ‚úÖ Discord —Ä–æ–ª—å - –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–Ω–≥–∞
- ‚úÖ –ù–µ–ª—å–∑—è –∞–±—å—é–∑–∏—Ç—å —á–µ—Ä–µ–∑ Discord
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–Ω–≥–∞ –≤ Discord –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

### Retry –º–µ—Ö–∞–Ω–∏–∑–º:
- ‚úÖ –î–æ 3 –ø–æ–ø—ã—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –°—á—ë—Ç—á–∏–∫ `retries` –≤ –ë–î
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –≤ `error_message`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏:
```
üîÑ SyncWorker: –Ω–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
üìã SyncWorker: –æ–±—Ä–∞–±–æ—Ç–∫–∞ 5 —Å–æ–±—ã—Ç–∏–π
‚úÖ SyncWorker: –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ 5, –ø—Ä–æ–≤–∞–ª–µ–Ω–æ 0
üîç ReconcileWorker: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
‚úÖ ReconcileWorker: 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 2 —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
üßπ CleanupWorker: –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```python
stats = await sync_service.get_stats()
# {
#   'pending': 5,
#   'processing': 2,
#   'completed': 1234,
#   'failed': 3,
#   'total': 1244
# }
```

### SQL –∑–∞–ø—Ä–æ—Å—ã:
```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
SELECT * FROM sync_events ORDER BY created_at DESC LIMIT 10;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
SELECT status, COUNT(*) FROM sync_events GROUP BY status;

-- –ü—Ä–æ–≤–∞–ª–∏–≤—à–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è
SELECT * FROM sync_events WHERE status = 'failed';

-- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT * FROM transactions WHERE user_id = 123 ORDER BY created_at DESC;

-- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
SELECT * FROM sync_state WHERE user_id = 123;
```

---

## ‚ùå –ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (TODO)

### 1. Discord Bot (discord.py) ‚ùå
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–í—Ä–µ–º—è:** 3-4 —á–∞—Å–∞

–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:
- Discord Bot –ø—Ä–æ–µ–∫—Ç —Å discord.py v2.x
- –ö–æ–º–∞–Ω–¥—ã:
  - `/link <code>` - –ø—Ä–∏–≤—è–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
  - `/unlink` - –æ—Ç–≤—è–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
  - `/profile` - –ø—Ä–æ—Ñ–∏–ª—å (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç TG –¥–∞–Ω–Ω—ã–µ)
  - `/sync` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π:
  - `on_voice_state_update` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è XP –∑–∞ –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç
  - `on_message` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è XP –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
  - `on_member_update` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–æ–ª–µ–π
- API –¥–ª—è Telegram –±–æ—Ç–∞:
  - `add_xp(user_id, delta)` - –¥–æ–±–∞–≤–∏—Ç—å XP
  - `update_balance(user_id, delta)` - –æ–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
  - `sync_rank(user_id, rank_id)` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–Ω–≥
  - `grant_achievement_role(user_id, achievement_id)` - –≤—ã–¥–∞—Ç—å —Ä–æ–ª—å

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Telegram Bot ‚ùå
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–í—Ä–µ–º—è:** 1 —á–∞—Å

–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å:
- ‚úÖ `GameService` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π XP/–±–∞–ª–∞–Ω—Å–∞ (–ì–û–¢–û–í–û –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
- ‚ùå `UserService` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è daily reward
- ‚ùå `SeasonService` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Ä–∞–Ω–≥–∞
- ‚ùå `AchievementService` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- ‚úÖ `main_v3.py` - –∑–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤ (–ì–û–¢–û–í–û –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)

### 3. Rank Role Mapping ‚ùå
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç

–ù—É–∂–Ω–æ:
- –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ Discord role_id —Å —Å–µ—Ä–≤–µ—Ä–∞
- –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `rank_role_mappings`
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–º–µ–Ω—É —Ä–æ–ª–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–Ω–≥–∞
- –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞–ø–ø–∏–Ω–≥–æ–º

### 4. Discord Bot API Integration ‚ùå
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–í—Ä–µ–º—è:** 2 —á–∞—Å–∞

–ù—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ `DiscordClient`:
- –ú–µ—Ç–æ–¥—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è XP (—á–µ—Ä–µ–∑ custom bot commands)
- –ú–µ—Ç–æ–¥—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
- –ú–µ—Ç–æ–¥—ã –¥–ª—è —Å–º–µ–Ω—ã —Ä–æ–ª–µ–π —Ä–∞–Ω–≥–∞
- –ú–µ—Ç–æ–¥—ã –¥–ª—è –≤—ã–¥–∞—á–∏ —Ä–æ–ª–µ–π –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ Discord API

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚ùå
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–í—Ä–µ–º—è:** 2-3 —á–∞—Å–∞

–ù—É–∂–Ω–æ:
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è `SyncService`
- Integration —Ç–µ—Å—Ç—ã –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –¢–µ—Å—Ç—ã –¥–ª—è reconcile
- –¢–µ—Å—Ç—ã –¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (40 –º–∏–Ω—É—Ç):
1. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 006
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ main_v3.py
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å GameService
4. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø.md`

### –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (3-4 —á–∞—Å–∞):
1. ‚ùå –°–æ–∑–¥–∞—Ç—å Discord Bot –ø—Ä–æ–µ–∫—Ç
2. ‚ùå –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
3. ‚ùå –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å SyncService
4. ‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `–°–õ–ï–î–£–Æ–©–ò–ï_–®–ê–ì–ò_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø.md`

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:

1. **–ì–û–¢–û–í–û_–î–í–£–°–¢–û–†–û–ù–ù–Ø–Ø_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø_–≠–¢–ê–ü_1.md**
   - –ü–æ–ª–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≠—Ç–∞–ø–∞ 1
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - Edge cases
   - Roadmap

2. **–°–õ–ï–î–£–Æ–©–ò–ï_–®–ê–ì–ò_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø.md**
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
   - –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω
   - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
   - –û—Ç–ª–∞–¥–∫–∞

3. **–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø.md**
   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (40 –º–∏–Ω—É—Ç)
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –û—Ç–ª–∞–¥–∫–∞

4. **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê_–î–í–£–°–¢–û–†–û–ù–ù–ï–ô_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò.md**
   - –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
   - –ü–æ—Ç–æ–∫–∏ —Å–æ–±—ã—Ç–∏–π
   - –°—Ç—Ä–∞—Ç–µ–≥–∏–∏
   - Edge cases

5. **–§–ò–ù–ê–õ–¨–ù–ê–Ø_–°–í–û–î–ö–ê_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø.md** (—ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç)
   - –û–±—â–∞—è —Å–≤–æ–¥–∫–∞
   - –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
   - –ß—Ç–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
   - –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- **–ú–æ–¥–µ–ª–∏:** 1 —Ñ–∞–π–ª (sync_event.py)
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** 1 —Ñ–∞–π–ª (006_bidirectional_sync.sql)
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:** 1 —Ñ–∞–π–ª (sync_repository.py)
- **–°–µ—Ä–≤–∏—Å—ã:** 1 —Ñ–∞–π–ª (sync_service.py)
- **Jobs:** 1 —Ñ–∞–π–ª (sync_worker.py)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 5 —Ñ–∞–π–ª–æ–≤

**–ò—Ç–æ–≥–æ:** 10 —Ñ–∞–π–ª–æ–≤

### –°—Ç—Ä–æ–∫ –∫–æ–¥–∞:
- **–ú–æ–¥–µ–ª–∏:** ~200 —Å—Ç—Ä–æ–∫
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** ~200 —Å—Ç—Ä–æ–∫
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:** ~500 —Å—Ç—Ä–æ–∫
- **–°–µ—Ä–≤–∏—Å—ã:** ~700 —Å—Ç—Ä–æ–∫
- **Jobs:** ~400 —Å—Ç—Ä–æ–∫
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ~2000 —Å—Ç—Ä–æ–∫

**–ò—Ç–æ–≥–æ:** ~4000 —Å—Ç—Ä–æ–∫

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- **–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π:** 5 (xp_change, balance_change, rank_change, achievement_unlock, reward_grant)
- **–í–æ—Ä–∫–µ—Ä—ã:** 3 (SyncWorker, ReconcileWorker, CleanupWorker)
- **–¢–∞–±–ª–∏—Ü—ã –ë–î:** 4 (sync_events, transactions, sync_state, rank_role_mappings)
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** Rank-Derived (—Ä–∞–Ω–≥ –∏–∑ XP)

---

## ‚úÖ –ò—Ç–æ–≥–∏

**–≠—Ç–∞–ø 1 –∑–∞–≤–µ—Ä—à—ë–Ω!**

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- ‚úÖ –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –§–æ–Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ì–æ—Ç–æ–≤–æ –∫:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ Telegram Bot (40 –º–∏–Ω—É—Ç)
- –°–æ–∑–¥–∞–Ω–∏—é Discord Bot (3-4 —á–∞—Å–∞)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- –î–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é

**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:**
- –°–æ–∑–¥–∞—Ç—å Discord Bot
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 08.02.2026  
**–í–µ—Ä—Å–∏—è:** v3.0 + Bidirectional Sync (–≠—Ç–∞–ø 1)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** Kiro AI Assistant  
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Event-Driven + Idempotency + Rank-Derived  
**–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** ~2 —á–∞—Å–∞  
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~4000  
**–§–∞–π–ª–æ–≤:** 10

